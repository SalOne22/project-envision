{"mappings":"C,A,W,S,E,C,E,O,G,E,W,E,Q,C,C,I,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,C,E,E,C,E,E,E,iB,O,I,A,C,E,S,C,E,G,K,E,O,C,C,E,C,Q,G,K,E,C,I,E,C,C,E,A,Q,C,C,E,C,I,E,C,G,E,Q,C,C,E,O,C,C,E,C,E,E,K,E,Q,E,E,S,E,O,C,I,E,A,M,uB,E,I,O,E,K,mB,C,C,E,S,S,C,C,C,E,C,C,E,C,C,E,E,kB,G,E,S,E,S,I,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,S,E,E,SGcA,IAAI,EAAO,EAcX,SAAS,EAAsB,CAAM,EACnC,AAAA,CAAA,EAAA,EAAA,OAAA,EAAK,aAAa,mBAChB,YACA,EAAO,IAAI,EAAA,SAAiB,KAAK,KAEnC,AAAA,EAAA,QAAK,aAAa,QAAQ,KAAO,EACjC,AAAA,CAAA,EAAA,EAAA,OAAA,GACF,CAEA,eAAe,IACb,IAAM,EAAS,MAAM,AAAA,CAAA,EAAA,EAAA,OAAA,EAAc,AAAA,CAAA,EAAA,EAAA,UAAA,EAzBnB,IA2BhB,GAAI,AAAkB,IAAlB,EAAO,OAAc,CACvB,AAAA,CAAA,EAAA,EAAA,OAAA,EAAK,WAAW,UAAU,OAAO,aACjC,AAAA,CAAA,EAAA,EAAA,OAAA,EAAK,aAAa,UAAU,IAAI,aAChC,MACF,CAEI,EAAO,OAjCK,GAkCd,AAAA,CAAA,EAAA,EAAA,OAAA,EAAK,cAAc,UAAU,IAAI,aAGnC,EAAsB,GAGtB,IAAM,EAAU,SAAS,cAAc,+BACvC,EAAQ,iBAAiB,QAAS,AAAA,IAChC,IAAM,EAAY,EAAE,OAAO,QAAQ,YACnC,GAAI,CAAC,EAAW,OAChB,IAAM,EAAU,EAAU,QAAQ,GAClC,AAAA,CAAA,EAAA,EAAA,mBAAA,EAAoB,EACtB,EAEF,CAEA,SAAS,EAAoB,CAAG,EAC9B,IAAM,EAAS,AAAA,EAAA,QAAK,aAAa,WAC7B,EAAS,EAAI,OAAO,KAEpB,AAAW,CAAA,OAAX,EACF,EAAO,QAAQ,AAAA,GAAS,EAAM,UAAU,OAAO,cAE/C,EAAO,QAAQ,AAAA,IACb,EAAM,QAAQ,OAAO,MAAM,KAAK,SAAS,GACrC,EAAM,UAAU,OAAO,aACvB,EAAM,UAAU,IAAI,YAC1B,EAEJ,CAEA,eAAe,KACb,AAYF,WACE,AAAA,EAAA,QAAK,eAAe,aAAa,MAAQ,KACzC,IAAM,EAAM,IAAI,MAAM,UACtB,AAAA,CAAA,EAAA,EAAA,OAAA,EAAK,eAAe,cAAc,EACpC,IAfE,IAAM,EAAS,MAAM,AAAA,CAAA,EAAA,EAAA,OAAA,EAAc,AAAA,CAAA,EAAA,EAAA,UAAA,EAnEnB,EAmEyC,GAErD,CAAA,EAAO,OArEK,GAsEd,AAAA,CAAA,EAAA,EAAA,OAAA,EAAK,cAAc,UAAU,IAAI,aAGnC,GAAQ,EAER,EAAsB,EACxB,CAzEA,OAAO,iBAAiB,mBAExB,WACE,AAAA,CAAA,EAAA,EAAA,OAAA,EAAgB,AAAA,EAAA,GAAK,OAAQ,AAAA,EAAA,QAAK,gBAClC,IAEA,IAAM,EAAc,AAAA,EAAA,GAAa,AAAA,EAAA,QAAK,eAAe,CAAC,EAAE,CAExD,EAAY,OAAO,iBAAiB,SAAU,GAC9C,AAAA,CAAA,EAAA,EAAA,OAAA,EAAK,cAAc,iBAAiB,QAAS,EAC/C,G,E,S,E,Q","sources":["<anon>","src/library.js","src/js/libraru_page/index.js","src/js/libraru_page/section_library.js"],"sourcesContent":["(function () {\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\nvar $parcel$global =\ntypeof globalThis !== 'undefined'\n  ? globalThis\n  : typeof self !== 'undefined'\n  ? self\n  : typeof window !== 'undefined'\n  ? window\n  : typeof global !== 'undefined'\n  ? global\n  : {};\nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequire34ff\"];\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequire34ff\"] = parcelRequire;\n}\nparcelRequire(\"i8Q71\");\nparcelRequire(\"j55CI\");\n\nvar $6sNo0 = parcelRequire(\"6sNo0\");\n\nvar $kV76N = parcelRequire(\"kV76N\");\n\nvar $14Rx2 = parcelRequire(\"14Rx2\");\n\nvar $aBmqH = parcelRequire(\"aBmqH\");\n\nvar $16wVm = parcelRequire(\"16wVm\");\n\nvar $lbGsy = parcelRequire(\"lbGsy\");\n\nvar $4DnXZ = parcelRequire(\"4DnXZ\");\n\nvar $XcJ0g = parcelRequire(\"XcJ0g\");\n\n\nvar $kvC6y = parcelRequire(\"kvC6y\");\nconst $fe6e9c4af98b7c03$var$PAGE_SIZE = 9;\nlet $fe6e9c4af98b7c03$var$page = 1;\nwindow.addEventListener(\"DOMContentLoaded\", $fe6e9c4af98b7c03$var$init);\nfunction $fe6e9c4af98b7c03$var$init() {\n    (0, $kV76N.default)((0, (/*@__PURE__*/$parcel$interopDefault($XcJ0g))).genres, (0, $lbGsy.default).genresSelectEl);\n    $fe6e9c4af98b7c03$var$initLibrary();\n    const genreSelect = (0, (/*@__PURE__*/$parcel$interopDefault($4DnXZ)))((0, $lbGsy.default).genresSelectEl)[0];\n    genreSelect.select.addEventListener(\"change\", $fe6e9c4af98b7c03$var$filterMoviesByGenre);\n    (0, $lbGsy.default).loadMoreBtnEl.addEventListener(\"click\", $fe6e9c4af98b7c03$var$onLoadMore);\n}\nfunction $fe6e9c4af98b7c03$var$appendMoviesToLibrary(movies) {\n    (0, $lbGsy.default).moviesListEl.insertAdjacentHTML(\"beforeend\", movies.map((0, $6sNo0.default)).join(\"\"));\n    (0, $lbGsy.default).moviesListEl.dataset.page = $fe6e9c4af98b7c03$var$page;\n    (0, $14Rx2.default)();\n}\nasync function $fe6e9c4af98b7c03$var$initLibrary() {\n    const movies = await (0, $kvC6y.default)((0, $aBmqH.loadMovies)($fe6e9c4af98b7c03$var$PAGE_SIZE));\n    if (movies.length === 0) {\n        (0, $lbGsy.default).emptyLibEl.classList.remove(\"is-hidden\");\n        (0, $lbGsy.default).libCatalogEl.classList.add(\"is-hidden\");\n        return;\n    }\n    if (movies.length < $fe6e9c4af98b7c03$var$PAGE_SIZE) (0, $lbGsy.default).loadMoreBtnEl.classList.add(\"is-hidden\");\n    $fe6e9c4af98b7c03$var$appendMoviesToLibrary(movies);\n    // START Добавляем слушателя для открытия модалки\n    const catalog = document.querySelector(\".list-movie-card.js-gallery\");\n    catalog.addEventListener(\"click\", (e)=>{\n        const closestId = e.target.closest(\".m-modal\");\n        if (!closestId) return;\n        const movieId = closestId.dataset.id;\n        (0, $16wVm.onOpenModalFilmById)(movieId);\n    });\n// END\n}\nfunction $fe6e9c4af98b7c03$var$filterMoviesByGenre(evt) {\n    const movies = (0, $lbGsy.default).moviesListEl.childNodes;\n    let filter = evt.target.value;\n    if (filter === \"-1\") movies.forEach((movie)=>movie.classList.remove(\"is-hidden\"));\n    else movies.forEach((movie)=>{\n        movie.dataset.genres.split(\",\").includes(filter) ? movie.classList.remove(\"is-hidden\") : movie.classList.add(\"is-hidden\");\n    });\n}\nasync function $fe6e9c4af98b7c03$var$onLoadMore() {\n    $fe6e9c4af98b7c03$var$resetSelect();\n    const movies = await (0, $kvC6y.default)((0, $aBmqH.loadMovies)($fe6e9c4af98b7c03$var$PAGE_SIZE, $fe6e9c4af98b7c03$var$page));\n    if (movies.length < $fe6e9c4af98b7c03$var$PAGE_SIZE) (0, $lbGsy.default).loadMoreBtnEl.classList.add(\"is-hidden\");\n    $fe6e9c4af98b7c03$var$page += 1;\n    $fe6e9c4af98b7c03$var$appendMoviesToLibrary(movies);\n}\nfunction $fe6e9c4af98b7c03$var$resetSelect() {\n    (0, $lbGsy.default).genresSelectEl.customSelect.value = \"-1\";\n    const evt = new Event(\"change\");\n    (0, $lbGsy.default).genresSelectEl.dispatchEvent(evt);\n}\n\n\n\n\nparcelRequire(\"bf8lc\");\nparcelRequire(\"cs2b8\");\n\n})();\n//# sourceMappingURL=library.46a7935d.js.map\n","import './js/header';\n\nimport './js/libraru_page';\n\nimport './js/modals';\n\nimport './js/go_to_top_btn';\n","import '../components/Hero/Hero';\nimport './section_library';\n","import movieCardMarkup from '../markup/movieCardMarkup';\nimport populateOptions from '../utils/populateOptions';\nimport initRatings from '../utils/initRating';\nimport { loadMovies } from '../api/libraryAPI';\nimport { onOpenModalFilmById } from '../modals/modal_film';\nimport refs from '../refs/library-refs';\n\nimport customSelect from 'custom-select';\n\nimport data from '../genres.json';\nimport 'custom-select/build/custom-select.css';\nimport loaderWrapper from '../loader';\n\nconst PAGE_SIZE = 9;\nlet page = 1;\n\nwindow.addEventListener('DOMContentLoaded', init);\n\nfunction init() {\n  populateOptions(data.genres, refs.genresSelectEl);\n  initLibrary();\n\n  const genreSelect = customSelect(refs.genresSelectEl)[0];\n\n  genreSelect.select.addEventListener('change', filterMoviesByGenre);\n  refs.loadMoreBtnEl.addEventListener('click', onLoadMore);\n}\n\nfunction appendMoviesToLibrary(movies) {\n  refs.moviesListEl.insertAdjacentHTML(\n    'beforeend',\n    movies.map(movieCardMarkup).join('')\n  );\n  refs.moviesListEl.dataset.page = page;\n  initRatings();\n}\n\nasync function initLibrary() {\n  const movies = await loaderWrapper(loadMovies(PAGE_SIZE));\n\n  if (movies.length === 0) {\n    refs.emptyLibEl.classList.remove('is-hidden');\n    refs.libCatalogEl.classList.add('is-hidden');\n    return;\n  }\n\n  if (movies.length < PAGE_SIZE) {\n    refs.loadMoreBtnEl.classList.add('is-hidden');\n  }\n\n  appendMoviesToLibrary(movies);\n\n  // START Добавляем слушателя для открытия модалки\n  const catalog = document.querySelector('.list-movie-card.js-gallery');\n  catalog.addEventListener('click', e => {\n    const closestId = e.target.closest('.m-modal');\n    if (!closestId) return;\n    const movieId = closestId.dataset.id;\n    onOpenModalFilmById(movieId);\n  });\n  // END\n}\n\nfunction filterMoviesByGenre(evt) {\n  const movies = refs.moviesListEl.childNodes;\n  let filter = evt.target.value;\n\n  if (filter === '-1') {\n    movies.forEach(movie => movie.classList.remove('is-hidden'));\n  } else {\n    movies.forEach(movie => {\n      movie.dataset.genres.split(',').includes(filter)\n        ? movie.classList.remove('is-hidden')\n        : movie.classList.add('is-hidden');\n    });\n  }\n}\n\nasync function onLoadMore() {\n  resetSelect();\n  const movies = await loaderWrapper(loadMovies(PAGE_SIZE, page));\n\n  if (movies.length < PAGE_SIZE) {\n    refs.loadMoreBtnEl.classList.add('is-hidden');\n  }\n\n  page += 1;\n\n  appendMoviesToLibrary(movies);\n}\n\nfunction resetSelect() {\n  refs.genresSelectEl.customSelect.value = '-1';\n  const evt = new Event('change');\n  refs.genresSelectEl.dispatchEvent(evt);\n}\n"],"names":["$parcel$interopDefault","a","__esModule","default","$parcel$global","globalThis","self","window","global","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","$6sNo0","$kV76N","$14Rx2","$aBmqH","$16wVm","$lbGsy","$4DnXZ","$XcJ0g","$kvC6y","$fe6e9c4af98b7c03$var$page","$fe6e9c4af98b7c03$var$appendMoviesToLibrary","movies","moviesListEl","insertAdjacentHTML","map","join","dataset","page","$fe6e9c4af98b7c03$var$initLibrary","loadMovies","length","emptyLibEl","classList","remove","libCatalogEl","add","loadMoreBtnEl","catalog","document","querySelector","addEventListener","e","closestId","target","closest","movieId","onOpenModalFilmById","$fe6e9c4af98b7c03$var$filterMoviesByGenre","evt","childNodes","filter","value","forEach","movie","genres","split","includes","$fe6e9c4af98b7c03$var$onLoadMore","$fe6e9c4af98b7c03$var$resetSelect","genresSelectEl","customSelect","Event","dispatchEvent","genreSelect","select"],"version":3,"file":"library.46a7935d.js.map"}